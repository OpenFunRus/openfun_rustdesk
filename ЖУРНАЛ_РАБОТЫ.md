# üìù –ñ—É—Ä–Ω–∞–ª —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º RustDesk

## üóìÔ∏è 16 —è–Ω–≤–∞—Ä—è 2026

### 1. –§–æ—Ä–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- –û—Ç–∫—Ä—ã–ª https://github.com/rustdesk/rustdesk
- –ù–∞–∂–∞–ª **Fork**
- –°–æ–∑–¥–∞–ª: https://github.com/OpenFunRus/openfun_rustdesk

### 2. –£–¥–∞–ª–µ–Ω–∏–µ `.gitmodules` –Ω–∞ GitHub
- –ü–µ—Ä–µ—à—ë–ª –≤ —Ñ–æ—Ä–∫ –Ω–∞ GitHub
- –£–¥–∞–ª–∏–ª —Ñ–∞–π–ª `.gitmodules` —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- Commit: "Delete .gitmodules"

### 3. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- –°–∫–∞—á–∞–ª ZIP –∞—Ä—Ö–∏–≤ —Ñ–æ—Ä–∫–∞
- –†–∞—Å–ø–∞–∫–æ–≤–∞–ª –≤ `D:\Cursor\rustdesk-1.4.5\`

### 4. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –°–∫–æ–ø–∏—Ä–æ–≤–∞–ª `–ö–ê–°–¢–û–ú–ò–ó–ê–¶–ò–Ø.md` –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
- –°–∫–æ–ø–∏—Ä–æ–≤–∞–ª `build-x86-sciter-only.yml` –≤ `.github/workflows/`

### 5. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ `hbb_common`
```bash
cd D:\Cursor\rustdesk-1.4.5\libs
git clone https://github.com/rustdesk/hbb_common.git hbb_common_temp
Remove-Item -Recurse -Force hbb_common
Move-Item hbb_common_temp hbb_common
```

### 6. –£–¥–∞–ª–µ–Ω–∏–µ `.git` –∏–∑ `hbb_common`
```bash
cd D:\Cursor\rustdesk-1.4.5\libs\hbb_common
Remove-Item -Recurse -Force .git
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** `hbb_common` —Ç–µ–ø–µ—Ä—å –æ–±—ã—á–Ω–∞—è –ø–∞–ø–∫–∞ (31 —Ñ–∞–π–ª), –Ω–µ submodule

### 7. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ Git
```bash
cd D:\Cursor\rustdesk-1.4.5
git add .
git commit -m "Update: Fresh fork with all customizations and hbb_common as regular folder"
```

### 8. Push –Ω–∞ GitHub
```bash
git push -f origin master
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ https://github.com/OpenFunRus/openfun_rustdesk

### 9. –°–æ–∑–¥–∞–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ —Ä–∞–±–æ—Ç—ã
- –°–æ–∑–¥–∞–ª `–ñ–£–†–ù–ê–õ_–†–ê–ë–û–¢–´.md`
- –ó–∞–≥—Ä—É–∑–∏–ª –Ω–∞ GitHub

---

## üìã –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –ß—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ:
- `libs/hbb_common/` - 31 —Ñ–∞–π–ª (–æ–±—ã—á–Ω–∞—è –ø–∞–ø–∫–∞, –Ω–µ submodule)
- `–ö–ê–°–¢–û–ú–ò–ó–ê–¶–ò–Ø.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º
- `.github/workflows/build-x86-sciter-only.yml` - workflow –¥–ª—è —Å–±–æ—Ä–∫–∏
- `–ñ–£–†–ù–ê–õ_–†–ê–ë–û–¢–´.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

### ‚úÖ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–∏–∑ –ö–ê–°–¢–û–ú–ò–ó–ê–¶–ò–Ø.md):
- `src/ui/index.tis` - –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π UI
- `src/ui/index.css` - Tabler.io Dark Theme
- `src/common.rs` - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ENV –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞/–∫–ª—é—á/API
- `src/ipc.rs` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–ø–∏—Å–∏ –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

---

### 10. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `libs/portable/src/res/label.png`
```
error: couldn't read libs\portable\src\./res/label.png: 
The system cannot find the file specified. (os error 2)
```

**–ü—Ä–∏—á–∏–Ω–∞:** –§–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–æ –Ω–µ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ Git

**–†–µ—à–µ–Ω–∏–µ:**
```bash
cd D:\Cursor\rustdesk-1.4.5
git add -f libs/portable/src/res/
git commit -m "Fix build: Add missing label.png resource file"
git push origin master
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –§–∞–π–ª –¥–æ–±–∞–≤–ª–µ–Ω, –æ—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞

### 11. –ü–µ—Ä–≤–∞—è —É—Å–ø–µ—à–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è
- –ó–∞–ø—É—Å—Ç–∏–ª workflow **"Build Only x86 Sciter Version"** –Ω–∞ GitHub Actions
- –ü–µ—Ä–µ—à—ë–ª: https://github.com/OpenFunRus/openfun_rustdesk/actions
- –ù–∞–∂–∞–ª **"Run workflow"**
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —É—Å–ø–µ—à–Ω–æ!

### 12. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets
–î–æ–±–∞–≤–∏–ª —Å–µ–∫—Ä–µ—Ç—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
- –ü–µ—Ä–µ—à—ë–ª: **Settings** ‚Üí **Secrets and variables** ‚Üí **Actions**
- –ù–∞–∂–∞–ª **"New repository secret"**

–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:
1. `RENDEZVOUS_SERVER` - –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `85.113.41.100:21116`)
2. `RS_PUB_KEY` - –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞
3. `API_SERVER` - –∞–¥—Ä–µ—Å API (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://85.113.41.100`)
4. `RS_PASSWORD` - —Å—Ç–∞—Ç–∏—á–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –∫–∞—Å—Å–∏—Ä–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –í—Å–µ 4 —Å–µ–∫—Ä–µ—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω—ã

### 13. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏
- –ó–∞–ø—É—Å—Ç–∏–ª workflow –∑–∞–Ω–æ–≤–æ: **"Run workflow"**
- –°–µ–∫—Ä–µ—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã, –Ω–æ **–∫–æ–¥ –µ—â–µ –Ω–µ –∏–∑–º–µ–Ω–µ–Ω** –¥–ª—è –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–û–∂–∏–¥–∞—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –û–±—ã—á–Ω–∞—è —Å–±–æ—Ä–∫–∞ (ENV –ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

### 14. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã —á–µ—Ä–µ–∑ HARDCODED –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
**–ó–∞–¥–∞—á–∞:** –ñ—ë—Å—Ç–∫–æ –∑–∞—à–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∫–æ–¥, —á—Ç–æ–±—ã –Ω–µ–ª—å–∑—è –±—ã–ª–æ –∏–∑–º–µ–Ω–∏—Ç—å

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**

#### `libs/hbb_common/src/config.rs`
–î–æ–±–∞–≤–ª–µ–Ω—ã immutable –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (—á–∏—Ç–∞—é—Ç—Å—è –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏):
```rust
pub const HARDCODED_RENDEZVOUS_SERVER: &str = option_env!("RENDEZVOUS_SERVER").unwrap_or("");
pub const HARDCODED_KEY: &str = option_env!("RS_PUB_KEY").unwrap_or("");
pub const HARDCODED_API_SERVER: &str = option_env!("API_SERVER").unwrap_or("");
pub const HARDCODED_PASSWORD: &str = option_env!("RS_PASSWORD").unwrap_or("");
```

#### `src/common.rs`
–ò–∑–º–µ–Ω—ë–Ω –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤ 3 —Ñ—É–Ω–∫—Ü–∏—è—Ö:
1. `get_custom_rendezvous_server()` - HARDCODED –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ü–ï–†–í–´–ú
2. `get_key()` - HARDCODED –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ü–ï–†–í–´–ú
3. `get_api_server_()` - HARDCODED –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ü–ï–†–í–´–ú

#### `src/ipc.rs`
–î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è:
1. `get_permanent_password()` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç HARDCODED –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
2. `set_permanent_password()` - –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –µ—Å–ª–∏ HARDCODED
3. `set_options()` - —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –∏ –ù–ï —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- ‚úÖ –ï—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞—à–∏—Ç—ã —á–µ—Ä–µ–∑ GitHub Secrets - –∏—Ö –ù–ï–õ–¨–ó–Ø –∏–∑–º–µ–Ω–∏—Ç—å
- ‚úÖ .toml —Ñ–∞–π–ª—ã –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
- ‚úÖ EXE –∏–º—è –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ UI –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª—ã

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (4 –≤–æ–ø—Ä–æ—Å–∞):**
1. ‚úÖ –ó–∞—à–∏—Ç—ã –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏? **–î–ê** - `option_env!()` —á–∏—Ç–∞–µ—Ç –∏–∑ GitHub Secrets
2. ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ .toml –Ω–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è? **–î–ê** - –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø–µ—Ä–≤—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
3. ‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ EXE –Ω–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è? **–î–ê** - –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–∞–Ω—å—à–µ EXE –∏–º–µ–Ω–∏
4. ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ UI –Ω–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è? **–î–ê** - —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏

### 15. –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ GitHub
```bash
git add .
git commit -m "Security: Implement HARDCODED constants for server, key, API, password - immutable protection"
git push origin master
```

**Commit:** `d1c674c`  
**–ò–∑–º–µ–Ω–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 4 (hbb_common/config.rs, src/common.rs, src/ipc.rs, –ñ–£–†–ù–ê–õ_–†–ê–ë–û–¢–´.md)

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è

### –î–µ–π—Å—Ç–≤–∏–µ 16: –ó–∞–ø—É—Å–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Å –∑–∞—â–∏—â—ë–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- –ü–µ—Ä–µ–π—Ç–∏: https://github.com/OpenFunRus/openfun_rustdesk/actions
- –ó–∞–ø—É—Å—Ç–∏—Ç—å **"Build Only x86 Sciter Version"**

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ùå –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏!
```
error[E0015]: cannot call non-const fn `std::option::Option::<&str>::unwrap_or` in constants
```

**–ü—Ä–∏—á–∏–Ω–∞:** `unwrap_or()` –Ω–µ —è–≤–ª—è–µ—Ç—Å—è const —Ñ—É–Ω–∫—Ü–∏–µ–π, –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞—Ö.

### –î–µ–π—Å—Ç–≤–∏–µ 17: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –í `libs/hbb_common/src/config.rs` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `.unwrap_or("")`

**–ë–´–õ–û:**
```rust
pub const HARDCODED_RENDEZVOUS_SERVER: &str = option_env!("RENDEZVOUS_SERVER").unwrap_or("");
```

**–°–¢–ê–õ–û:**
```rust
pub const HARDCODED_RENDEZVOUS_SERVER: &str = match option_env!("RENDEZVOUS_SERVER") {
    Some(v) => v,
    None => "",
};
```

**–ò–∑–º–µ–Ω–µ–Ω–æ:** –í—Å–µ 4 –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (—Å–µ—Ä–≤–µ—Ä, –∫–ª—é—á, API, –ø–∞—Ä–æ–ª—å)

**–ó–∞–≥—Ä—É–∑–∫–∞:**
```bash
git add .
git commit -m "Fix: Use match instead of unwrap_or in const"
git push origin master
```

**Commit:** `44cd9a2`

### –î–µ–π—Å—Ç–≤–∏–µ 18: –ö–æ–º–ø–∏–ª—è—Ü–∏—è —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!  
**–ù–û:** –í–µ—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ID, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ù–ï –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è.

**–ü—Ä–æ–±–ª–µ–º–∞:** GitHub Secrets –ù–ï –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ workflow!

### –î–µ–π—Å—Ç–≤–∏–µ 19: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ workflow
**–§–∞–π–ª:** `.github/workflows/build-x86-sciter-only.yml`

**–ë–´–õ–û:**
```yaml
env:
  SCITER_RUST_VERSION: "1.75"
  VERSION: "1.4.5"
  VCPKG_COMMIT_ID: "120deac3062162151622ca4860575a33844ba10b"
  UPLOAD_ARTIFACT: "true"
```

**–°–¢–ê–õ–û:**
```yaml
env:
  SCITER_RUST_VERSION: "1.75"
  VERSION: "1.4.5"
  VCPKG_COMMIT_ID: "120deac3062162151622ca4860575a33844ba10b"
  UPLOAD_ARTIFACT: "true"
  RENDEZVOUS_SERVER: ${{ secrets.RENDEZVOUS_SERVER }}
  RS_PUB_KEY: ${{ secrets.RS_PUB_KEY }}
  API_SERVER: ${{ secrets.API_SERVER }}
  RS_PASSWORD: ${{ secrets.RS_PASSWORD }}
```

**–¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ:**
- `env` –±–ª–æ–∫ –≤ —à–∞–≥ "Build rustdesk x86 sciter"
- Debug echo –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ ENV
- –Ø–≤–Ω—ã–π `export` –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ `cargo build`

**–ó–∞–≥—Ä—É–∑–∫–∞:**
```bash
git add .
git commit -m "Fix: Add GitHub Secrets to workflow env for hardcoded settings"
git push origin master
```

**Commit:** `651fedd`

### –î–µ–π—Å—Ç–≤–∏–µ 20: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Force Relay –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –Ω–æ–≤–æ–º—É –∫–ª–∏–µ–Ω—Ç—É –∑–∞–¥–µ—Ä–∂–∫–∞ 10 —Å–µ–∫—É–Ω–¥ - –∏–¥—É—Ç –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä—è–º–æ–≥–æ P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ NAT type.

**–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å relay —Å–µ—Ä–≤–µ—Ä (–ø—É—Å–∫–∞—Ç—å —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä), –º–∏–Ω—É—è –ø–æ–ø—ã—Ç–∫–∏ punch hole.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

1. **`libs/hbb_common/src/config.rs`** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞:
```rust
pub const HARDCODED_FORCE_RELAY: bool = match option_env!("RS_FORCE_RELAY") {
    Some(v) => match v {
        "1" | "true" | "TRUE" | "True" | "yes" | "YES" => true,
        _ => false,
    },
    None => false,
};
```

2. **`src/client.rs`** - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è HARDCODED_FORCE_RELAY:
```rust
self.force_relay =
    config::HARDCODED_FORCE_RELAY
        || config::option2bool("force-always-relay", &self.get_option("force-always-relay"))
        || force_relay
        || use_ws()
        || Config::is_proxy();
```

3. **`.github/workflows/build-x86-sciter-only.yml`** - –¥–æ–±–∞–≤–ª–µ–Ω `RS_FORCE_RELAY` –≤ env

**–ü–ª—é—Å—ã:**
- ‚úÖ –ù–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ punch hole (—ç–∫–æ–Ω–æ–º–∏—è 5-10 —Å–µ–∫—É–Ω–¥!)
- ‚úÖ –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ NAT type
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ª—é–±—ã–µ —Ñ–∞–π—Ä–≤–æ–ª—ã
- ‚úÖ –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–∞—Å—Å–∏—Ä–∞–º

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –ï—Å–ª–∏ –≤ GitHub Secrets –¥–æ–±–∞–≤–∏—Ç—å `RS_FORCE_RELAY = 1` ‚Üí –≤—Å–µ–≥–¥–∞ —á–µ—Ä–µ–∑ relay
- –ï—Å–ª–∏ —Å–µ–∫—Ä–µ—Ç –ø—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω ‚Üí –æ–±—ã—á–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–ø–æ–ø—ã—Ç–∫–∞ P2P)

**–ó–∞–≥—Ä—É–∑–∫–∞:**
```bash
git add .
git commit -m "Feature: Add HARDCODED_FORCE_RELAY to always use relay server"
git push origin master
```

**Commit:** `3aea8a5`

### –î–µ–π—Å—Ç–≤–∏–µ 21: –ü—Ä–æ–±–ª–µ–º–∞ - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –ø—Ä–æ–ø–∏—Å–∞–ª–∏—Å—å –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏
**–ü—Ä–∏—á–∏–Ω–∞:** `option_env!()` —á–∏—Ç–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è **–≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ cargo**, –∞ –Ω–µ –∏–∑ GitHub Actions –Ω–∞–ø—Ä—è–º—É—é.

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–¥–∞—Ç—å ENV —á–µ—Ä–µ–∑ `build.rs` ‚Üí `cargo:rustc-env=`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `build.rs`:**
```rust
// Pass environment variables to rustc for option_env!() macro
if let Ok(server) = std::env::var("RENDEZVOUS_SERVER") {
    println!("cargo:rustc-env=RENDEZVOUS_SERVER={}", server);
}
if let Ok(key) = std::env::var("RS_PUB_KEY") {
    println!("cargo:rustc-env=RS_PUB_KEY={}", key);
}
if let Ok(api) = std::env::var("API_SERVER") {
    println!("cargo:rustc-env=API_SERVER={}", api);
}
if let Ok(pwd) = std::env::var("RS_PASSWORD") {
    println!("cargo:rustc-env=RS_PASSWORD={}", pwd);
}
if let Ok(relay) = std::env::var("RS_FORCE_RELAY") {
    println!("cargo:rustc-env=RS_FORCE_RELAY={}", relay);
}
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. GitHub Actions ‚Üí ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
2. `build.rs` —á–∏—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ `std::env::var()`
3. –ü–µ—Ä–µ–¥–∞—ë—Ç –≤ rustc —á–µ—Ä–µ–∑ `println!("cargo:rustc-env=...")`
4. `option_env!()` –ø–æ–ª—É—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

**–ó–∞–≥—Ä—É–∑–∫–∞:**
```bash
git add build.rs
git commit -m "Fix: Pass ENV to rustc via build.rs for option_env!() to work"
git push origin master
```

**Commit:** `4452b3b` ‚Üí `aa80c1d` (–ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤)

### –î–µ–π—Å—Ç–≤–∏–µ 22: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ - —É–¥–∞–ª–µ–Ω—ã –≤—Å–µ —Ñ–∞–π–ª—ã —Å GitHub
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ git —Å–¥–µ–ª–∞–ª `git init` + `git reset --soft origin/master`, –≤—Å–µ —Ñ–∞–π–ª—ã —Å—Ç–∞–ª–∏ untracked. –ó–∞–∫–æ–º–º–∏—Ç–∏–ª —Ç–æ–ª—å–∫–æ `build.rs`, –æ—Å—Ç–∞–ª—å–Ω–æ–µ —É–¥–∞–ª–∏–ª–æ—Å—å.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
git add .
git commit -m "Restore: Add all files back + build.rs fix"
git push origin master
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã  
**Commit:** `aa80c1d`

### –î–µ–π—Å—Ç–≤–∏–µ 23: –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ - –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω match —Å—Ç—Ä–æ–∫ –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:**
```
error[E0015]: cannot match on `str` in constants
libs\hbb_common\src\config.rs:97
```

**–ü—Ä–∏—á–∏–Ω–∞:** –í `HARDCODED_FORCE_RELAY` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –≤–ª–æ–∂–µ–Ω–Ω—ã–π match —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏, —á—Ç–æ –∑–∞–ø—Ä–µ—â–µ–Ω–æ –≤ const.

**–ë–´–õ–û:**
```rust
pub const HARDCODED_FORCE_RELAY: bool = match option_env!("RS_FORCE_RELAY") {
    Some(v) => match v {
        "1" | "true" | "TRUE" | "True" | "yes" | "YES" => true,
        _ => false,
    },
    None => false,
};
```

**–°–¢–ê–õ–û:**
```rust
pub const HARDCODED_FORCE_RELAY: &str = match option_env!("RS_FORCE_RELAY") {
    Some(v) => v,
    None => "",
};
```

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤ `src/client.rs`:**
```rust
// –ë–´–õ–û:
self.force_relay = config::HARDCODED_FORCE_RELAY || ...

// –°–¢–ê–õ–û:
self.force_relay = 
    (!config::HARDCODED_FORCE_RELAY.is_empty() && config::HARDCODED_FORCE_RELAY == "1")
    || ...
```

**–ó–∞–≥—Ä—É–∑–∫–∞:**
```bash
git add libs/hbb_common/src/config.rs src/client.rs
git commit -m "Fix: HARDCODED_FORCE_RELAY as string const, check value == '1' in runtime"
git push origin master
```

**Commit:** `5cdad40`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–π—Ç–∏ —É—Å–ø–µ—à–Ω–æ

---

## üéØ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Å–±–æ—Ä–∫–µ:
- –í—Å–µ 5 –∫–æ–Ω—Å—Ç–∞–Ω—Ç –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `build.rs` ‚Üí `cargo:rustc-env=`
- `HARDCODED_FORCE_RELAY` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω (—Å—Ç—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ bool)
- –í—Å–µ —Ñ–∞–π–ª—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ GitHub
- –ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Å GitHub Secrets

### üìã –î–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∑–∞—â–∏—Ç—ã:
–í **GitHub Secrets** –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
1. `RENDEZVOUS_SERVER` - –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
2. `RS_PUB_KEY` - –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á
3. `API_SERVER` - –∞–¥—Ä–µ—Å API
4. `RS_PASSWORD` - —Å—Ç–∞—Ç–∏—á–Ω—ã–π –ø–∞—Ä–æ–ª—å
5. `RS_FORCE_RELAY` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `1` –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

### üöÄ –°–ª–µ–¥—É—é—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ:
–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–±–æ—Ä–∫—É –Ω–∞ GitHub Actions –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞—à–∏–ª–∏—Å—å.

---
